<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Snake Game (Touch Support)</title>
  <style>
    body {
      margin: 0; 
      padding: 0; 
      background: #333; 
      display: flex; 
      flex-direction: column;
      align-items: center; 
      justify-content: flex-start; 
      min-height: 100vh; 
      color: #fff;
      font-family: sans-serif;
    }
    #gameCanvas {
      background: #000;
      display: block;
      margin-top: 20px;
    }
    #controls {
      display: flex;
      flex-wrap: wrap;
      width: 220px; /* фиксированная ширина блока кнопок */
      justify-content: space-around;
      margin-top: 10px;
    }
    button {
      width: 60px; 
      height: 60px;
      background: #555;
      color: #fff;
      border: none;
      font-size: 18px;
      cursor: pointer;
      margin: 5px;
      border-radius: 6px;
    }
    button:active {
      background: #666;
    }
    .wide {
      width: 130px;
    }
  </style>
</head>
<body>

<h1>Snake Game (Touch)</h1>

<canvas id="gameCanvas" width="400" height="400"></canvas>

<div id="controls">
  <button id="up">↑</button>
  <button id="left">←</button>
  <button id="right">→</button>
  <button id="down">↓</button>
</div>

<script>
/*
  Простейшая реализация «Змейки» с кнопками для управления.
*/

// Размер клетки, поле 400x400 => 20x20 клеток
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const gridSize = 20;
const tileCount = canvas.width / gridSize;

// Начальная позиция змейки
let snakeX = 10;
let snakeY = 10;

// Начальное направление
let velocityX = 0;
let velocityY = 0;

// Тело змейки
let snakeBody = [];
let snakeLength = 3;

// Яблоко
let appleX = 5;
let appleY = 5;

// Основной игровой цикл
function gameLoop() {
  snakeX += velocityX;
  snakeY += velocityY;

  // Заход за границы — портал
  if (snakeX < 0) snakeX = tileCount - 1;
  if (snakeX >= tileCount) snakeX = 0;
  if (snakeY < 0) snakeY = tileCount - 1;
  if (snakeY >= tileCount) snakeY = 0;

  // Фон
  ctx.fillStyle = 'black';
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  // Рисуем яблоко
  ctx.fillStyle = 'red';
  ctx.fillRect(appleX * gridSize, appleY * gridSize, gridSize - 2, gridSize - 2);

  // Добавляем текущую позицию головы змейки
  snakeBody.unshift({ x: snakeX, y: snakeY });

  // Лишние сегменты (если длина > snakeLength)
  while (snakeBody.length > snakeLength) {
    snakeBody.pop();
  }

  // Рисуем змейку
  ctx.fillStyle = 'lime';
  snakeBody.forEach(segment => {
    ctx.fillRect(segment.x * gridSize, segment.y * gridSize, gridSize - 2, gridSize - 2);
  });

  // Если съели яблоко
  if (snakeX === appleX && snakeY === appleY) {
    snakeLength++;
    appleX = Math.floor(Math.random() * tileCount);
    appleY = Math.floor(Math.random() * tileCount);
  }

  // Проверка столкновения с хвостом
  for (let i = 1; i < snakeBody.length; i++) {
    if (snakeBody[i].x === snakeX && snakeBody[i].y === snakeY) {
      // Сброс
      snakeLength = 3;
      velocityX = 0;
      velocityY = 0;
      // Укоротим массив — оставим только 3 сегмента
      snakeBody.splice(3);
      break;
    }
  }
}

// Запускаем игру c частотой ~10 fps
setInterval(gameLoop, 100);

// Управление с клавиатуры (для десктопа)
document.addEventListener('keydown', (event) => {
  switch (event.key) {
    case 'ArrowLeft':
      if (velocityX !== 1) { velocityX = -1; velocityY = 0; }
      break;
    case 'ArrowRight':
      if (velocityX !== -1) { velocityX = 1; velocityY = 0; }
      break;
    case 'ArrowUp':
      if (velocityY !== 1) { velocityX = 0; velocityY = -1; }
      break;
    case 'ArrowDown':
      if (velocityY !== -1) { velocityX = 0; velocityY = 1; }
      break;
  }
});

// Обработчики кликов на кнопках (для сенсорных экранов)
document.getElementById('left').onclick = () => {
  if (velocityX !== 1) {
    velocityX = -1;
    velocityY = 0;
  }
};
document.getElementById('right').onclick = () => {
  if (velocityX !== -1) {
    velocityX = 1;
    velocityY = 0;
  }
};
document.getElementById('up').onclick = () => {
  if (velocityY !== 1) {
    velocityX = 0;
    velocityY = -1;
  }
};
document.getElementById('down').onclick = () => {
  if (velocityY !== -1) {
    velocityX = 0;
    velocityY = 1;
  }
};
</script>
</body>
</html>
